{"ast":null,"code":"import { catchError, map, throwError } from \"rxjs\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/customer.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\n\nfunction CustomersComponent_ng_container_1_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"form\", 13);\n    i0.ɵɵlistener(\"ngSubmit\", function CustomersComponent_ng_container_1_div_5_Template_form_ngSubmit_1_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r6.handleSearchCustomers());\n    });\n    i0.ɵɵelementStart(2, \"div\", 14)(3, \"label\", 15);\n    i0.ɵɵtext(4, \"Keyword:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"input\", 16);\n    i0.ɵɵelementStart(6, \"button\", 17);\n    i0.ɵɵelement(7, \"i\", 18);\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroup\", ctx_r4.searchFormGroup);\n  }\n}\n\nfunction CustomersComponent_ng_container_1_tr_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\")(8, \"div\", 19)(9, \"button\", 20);\n    i0.ɵɵelement(10, \"i\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"button\", 22);\n    i0.ɵɵlistener(\"click\", function CustomersComponent_ng_container_1_tr_18_Template_button_click_11_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const c_r8 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r9.handleDeleteCustomer(c_r8));\n    });\n    i0.ɵɵelement(12, \"i\", 23);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function CustomersComponent_ng_container_1_tr_18_Template_button_click_13_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const c_r8 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r11.handleCustomerAccounts(c_r8));\n    });\n    i0.ɵɵelement(14, \"i\", 25);\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const c_r8 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(c_r8.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(c_r8.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(c_r8.email);\n  }\n}\n\nfunction CustomersComponent_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 4)(2, \"div\", 5);\n    i0.ɵɵtext(3, \"Customers\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 6);\n    i0.ɵɵtemplate(5, CustomersComponent_ng_container_1_div_5_Template, 8, 1, \"div\", 7);\n    i0.ɵɵelementStart(6, \"table\", 8)(7, \"thead\")(8, \"tr\")(9, \"th\");\n    i0.ɵɵtext(10, \"ID\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12, \"NAME\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"th\");\n    i0.ɵɵtext(14, \"EMAIL\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"th\", 9);\n    i0.ɵɵtext(16, \"ACTIONS\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(17, \"tbody\");\n    i0.ɵɵtemplate(18, CustomersComponent_ng_container_1_tr_18_Template, 15, 3, \"tr\", 10);\n    i0.ɵɵpipe(19, \"async\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(20, \"div\", 11)(21, \"a\", 12);\n    i0.ɵɵtext(22, \" Back to Home \");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.searchFormGroup);\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(19, 2, ctx_r0.customers));\n  }\n}\n\nfunction CustomersComponent_ng_template_3_ng_container_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 27);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r12 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r12.errorMessage, \" \");\n  }\n}\n\nfunction CustomersComponent_ng_template_3_ng_template_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \" Loading.... \");\n  }\n}\n\nfunction CustomersComponent_ng_template_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, CustomersComponent_ng_template_3_ng_container_0_Template, 3, 1, \"ng-container\", 1);\n    i0.ɵɵtemplate(1, CustomersComponent_ng_template_3_ng_template_1_Template, 1, 0, \"ng-template\", null, 26, i0.ɵɵtemplateRefExtractor);\n  }\n\n  if (rf & 2) {\n    const _r13 = i0.ɵɵreference(2);\n\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.errorMessage)(\"ngIfElse\", _r13);\n  }\n}\n\nexport class CustomersComponent {\n  constructor(customerService, fb, router) {\n    this.customerService = customerService;\n    this.fb = fb;\n    this.router = router;\n  }\n\n  ngOnInit() {\n    this.searchFormGroup = this.fb.group({\n      keyword: this.fb.control(\"\")\n    });\n    this.handleSearchCustomers();\n  }\n\n  handleSearchCustomers() {\n    let kw = this.searchFormGroup.value.keyword;\n    this.customers = this.customerService.searchCustomers(kw).pipe(catchError(err => {\n      this.errorMessage = err.message;\n      return throwError(err);\n    }));\n  }\n\n  handleDeleteCustomer(c) {\n    let conf = confirm(\"Are you sure?\");\n    if (!conf) return;\n    this.customerService.deleteCustomer(c.id).subscribe({\n      next: resp => {\n        this.customers = this.customers.pipe(map(data => {\n          let index = data.indexOf(c);\n          data.slice(index, 1);\n          return data;\n        }));\n      },\n      error: err => {\n        console.log(err);\n      }\n    });\n  }\n\n  handleCustomerAccounts(customer) {\n    this.router.navigateByUrl(\"/customer-accounts/\" + customer.id, {\n      state: customer\n    });\n  }\n\n  getIconClass(action) {\n    switch (action) {\n      case 'edit':\n        return 'bi bi-pencil';\n\n      case 'delete':\n        return 'bi bi-trash';\n\n      case 'accounts':\n        return 'bi bi-wallet';\n\n      default:\n        return '';\n    }\n  }\n\n}\n\nCustomersComponent.ɵfac = function CustomersComponent_Factory(t) {\n  return new (t || CustomersComponent)(i0.ɵɵdirectiveInject(i1.CustomerService), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i3.Router));\n};\n\nCustomersComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CustomersComponent,\n  selectors: [[\"app-customers\"]],\n  decls: 5,\n  vars: 4,\n  consts: [[1, \"container\", \"mt-5\"], [4, \"ngIf\", \"ngIfElse\"], [\"class\", \"text-danger\"], [\"failureOrLoading\", \"\"], [1, \"card\"], [1, \"card-header\", \"bg-primary\", \"text-white\"], [1, \"card-body\"], [4, \"ngIf\"], [1, \"table\", \"table-hover\"], [1, \"text-start\"], [4, \"ngFor\", \"ngForOf\"], [1, \"text-center\", \"mt-4\"], [\"routerLink\", \"/home\", 1, \"btn\", \"btn-primary\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"input-group\"], [1, \"input-group-text\"], [\"type\", \"text\", \"formControlName\", \"keyword\", 1, \"form-control\"], [1, \"btn\", \"btn-primary\"], [1, \"bi\", \"bi-search\"], [1, \"d-flex\", \"justify-content-start\"], [\"routerLink\", \"/editCustomer\", 1, \"btn\", \"btn-light\", \"btn-action\", \"me-4\"], [1, \"bi\", \"bi-pencil-fill\"], [1, \"btn\", \"btn-danger\", \"btn-action\", \"me-4\", 3, \"click\"], [1, \"bi\", \"bi-trash-fill\"], [1, \"btn\", \"btn-success\", \"btn-action\", \"me-4\", 3, \"click\"], [1, \"bi\", \"bi-wallet-fill\"], [\"loading\", \"\"], [1, \"text-danger\"]],\n  template: function CustomersComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtemplate(1, CustomersComponent_ng_container_1_Template, 23, 4, \"ng-container\", 1);\n      i0.ɵɵpipe(2, \"async\");\n      i0.ɵɵtemplate(3, CustomersComponent_ng_template_3_Template, 3, 2, \"ng-template\", 2, 3, i0.ɵɵtemplateRefExtractor);\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      const _r1 = i0.ɵɵreference(4);\n\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(2, 2, ctx.customers))(\"ngIfElse\", _r1);\n    }\n  },\n  dependencies: [i4.NgForOf, i4.NgIf, i3.RouterLink, i3.RouterLinkWithHref, i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormControlName, i4.AsyncPipe],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJjdXN0b21lcnMuY29tcG9uZW50LmNzcyJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["catchError","map","throwError","i0","_r13","CustomersComponent","constructor","customerService","fb","router","ngOnInit","searchFormGroup","group","keyword","control","handleSearchCustomers","kw","value","customers","searchCustomers","pipe","err","errorMessage","message","handleDeleteCustomer","c","conf","confirm","deleteCustomer","id","subscribe","next","resp","data","index","indexOf","slice","error","console","log","handleCustomerAccounts","customer","navigateByUrl","state","getIconClass","action","selectors","decls","vars","consts","template","_r1"],"sourceRoot":"","sources":["/Users/badre/Downloads/Digital-Banking/DigitalBfront/src/app/customers/customers.component.ts","/Users/badre/Downloads/Digital-Banking/DigitalBfront/src/app/customers/customers.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport {HttpClient} from \"@angular/common/http\";\nimport {error} from \"@angular/compiler-cli/src/transformers/util\";\nimport {CustomerService} from \"../services/customer.service\";\nimport {catchError, map, Observable, throwError} from \"rxjs\";\nimport {Customer} from \"../model/customer.model\";\nimport {FormBuilder, FormGroup} from \"@angular/forms\";\nimport {Router} from \"@angular/router\";\n\n@Component({\n  selector: 'app-customers',\n  templateUrl: './customers.component.html',\n  styleUrls: ['./customers.component.css']\n})\nexport class CustomersComponent implements OnInit {\n\n  customers! : Observable<Array<Customer>>;\n  errorMessage! : object;\n  searchFormGroup! : FormGroup;\n  constructor(private customerService : CustomerService, private fb : FormBuilder, private router : Router) { }\n\n  ngOnInit(): void {\n    this.searchFormGroup = this.fb.group({\n      keyword : this.fb.control(\"\")\n    })\n    this.handleSearchCustomers();\n  }\n\n  handleSearchCustomers() {\n    let kw = this.searchFormGroup.value.keyword;\n    this.customers=this.customerService.searchCustomers(kw).pipe(\n      catchError(err => {\n        this.errorMessage=err.message;\n        return throwError(err);\n      })\n    )\n  }\n\n  handleDeleteCustomer(c : Customer) {\n    let conf = confirm(\"Are you sure?\");\n    if(!conf) return;\n    this.customerService.deleteCustomer(c.id).subscribe({\n      next : (resp) => {\n        this.customers = this.customers.pipe(\n          map(data => {\n            let index = data.indexOf(c);\n            data.slice(index,1)\n            return data;\n          })\n        )\n      }, error : err => {\n        console.log(err)\n      }\n    })\n  }\n\n  handleCustomerAccounts(customer: Customer) {\n    this.router.navigateByUrl(\"/customer-accounts/\"+customer.id,{state :customer});\n  }\n\n  getIconClass(action: string): string {\n    switch (action) {\n      case 'edit':\n        return 'bi bi-pencil';\n      case 'delete':\n        return 'bi bi-trash';\n      case 'accounts':\n        return 'bi bi-wallet';\n      default:\n        return '';\n    }\n  }\n\n\n}\n","<div class=\"container mt-5\">\n  <ng-container *ngIf=\"customers | async as listCustomers; else failureOrLoading\">\n    <div class=\"card\">\n      <div class=\"card-header bg-primary text-white\">Customers</div>\n      <div class=\"card-body\">\n        <div *ngIf=\"searchFormGroup\">\n          <form [formGroup]=\"searchFormGroup\" (ngSubmit)=\"handleSearchCustomers()\">\n            <div class=\"input-group\">\n              <label class=\"input-group-text\">Keyword:</label>\n              <input type=\"text\" formControlName=\"keyword\" class=\"form-control\">\n              <button class=\"btn btn-primary\">\n                <i class=\"bi bi-search\"></i>\n              </button>\n            </div>\n          </form>\n        </div>\n        <table class=\"table table-hover\">\n          <thead>\n          <tr>\n            <th>ID</th>\n            <th>NAME</th>\n            <th>EMAIL</th>\n            <th class=\"text-start\">ACTIONS</th>\n          </tr>\n          </thead>\n          <tbody>\n          <tr *ngFor=\"let c of customers | async\">\n            <td>{{ c.id }}</td>\n            <td>{{ c.name }}</td>\n            <td>{{ c.email }}</td>\n            <td>\n              <div class=\"d-flex justify-content-start\">\n                <button class=\"btn btn-light btn-action me-4\" routerLink=\"/editCustomer\">\n                  <i class=\"bi bi-pencil-fill\"></i>\n                </button>\n                <button class=\"btn btn-danger btn-action me-4\" (click)=\"handleDeleteCustomer(c)\">\n                  <i class=\"bi bi-trash-fill\"></i>\n                </button>\n                <button class=\"btn btn-success btn-action me-4\" (click)=\"handleCustomerAccounts(c)\">\n                  <i class=\"bi bi-wallet-fill\"></i>\n                </button>\n              </div>\n            </td>\n          </tr>\n          </tbody>\n        </table>\n        <div class=\"text-center mt-4\">\n          <a class=\"btn btn-primary\" routerLink=\"/home\">\n            Back to Home\n          </a>\n        </div>\n      </div>\n\n    </div>\n\n  </ng-container>\n  <ng-template #failureOrLoading class=\"text-danger\">\n    <ng-container *ngIf=\"errorMessage; else loading\">\n      <div class=\"text-danger\">\n        {{ errorMessage }}\n      </div>\n    </ng-container>\n    <ng-template #loading>\n      Loading....\n    </ng-template>\n  </ng-template>\n</div>\n"]},"metadata":{},"sourceType":"module"}